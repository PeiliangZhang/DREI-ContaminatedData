# **Distributed Robust Estimation and Inference: Code and Simulations**

This repository contains the R code and simulation results for the paper titled **"Distributed Robust Estimation and Inference with Contaminated Data"**, authored by **Peiliang Zhang, Wen-Xin Zhou, and Zhao Ren**. The code implements distributed robust estimation and inference methods using Huber M-estimators and provides tools for visualizing their performance under various simulation setups.  

While the implementation primarily uses the Huber loss, it also accommodates other loss functions, such as Pseudo-Huber and Smooth-Huber. For more details, refer to Appendix A of our paper. Users can define their own robust loss functions and edit the code with minimal effort.

---

## **Repository Structure**

### **1. `utils/`**
This folder contains essential helper functions for robust distributed estimation. The main functions in `functions_estimation.R` include:

- **`Huber_GDBB`**: Implements gradient descent with the Barzilai-Borwein stepsize ([Barzilai and Borwein, 1988](https://academic.oup.com/imajna/article-abstract/8/1/141/802460)). See Appendix A of [Tan et al., 2022](https://jmlr.org/papers/v23/21-1269.html) for further details.
- **`Distributed_Huber`**: Implements the distributed Huber M-estimator algorithm.
- **`Huber_GDBB_w`**: Implements a distributed multiplier bootstrap estimator using weighted Huber regression.

---

### **2. `distributed_estimation/`**
This folder contains scripts for simulation studies on distributed robust estimation. These scripts evaluate the performance of the distributed Huber estimator under various configurations, comparing it with the global OLS estimator and the global Huber estimator (both assume access to the full dataset).

#### **Scripts**:
- **`distr_est_epsilon.R`**: Examines the effect of contamination proportion (\( \epsilon \)) and contamination scale (\( s \)) on distributed estimation.
- **`distr_est_FG.R`**: Analyzes the effect of noise distributions (\( F \)) and contamination distributions (\( G \)) on robust estimation.
- **`distr_est_n.R`**: Studies the impact of local sample size (\( n \)) on distributed estimation performance.
- **`distr_est_plot_generation.Rmd`**: Generates visualizations for the simulation results, such as confidence interval coverage and width.

#### **Results**:
- **`results/`**:
  - CSV files with simulation outputs for various configurations.
  - Plots summarizing performance metrics, such as \( \ell_2 \)-estimation errors.

---

### **3. `distributed_inference/`**
This folder contains scripts for distributed inference studies, focusing on constructing and visualizing distributed confidence intervals.

#### **Scripts**:
- **`distr_CI_epsilon.R`**: Explores the effect of contamination proportion (\( \epsilon \)) and contamination scale on distributed confidence intervals. It compares the following methods:
  1. **M-boot**: Distributed bootstrap confidence interval for distributed M-estimator.
  2. **Debias-M-boot**: Debiased distributed bootstrap confidence interval for distributed M-estimator.
  3. **M-normal**: Asymptotic normality-based confidence interval for distributed M-estimator.
  4. **OLS-normal**: Asymptotic normality-based confidence interval for global OLS estimator.
- **`distr_CI_plot_generation.Rmd`**: Generates visualizations for confidence interval coverage and width under various configurations.

#### **Results**:
- **`results/`**:
  - CSV files with simulation results for confidence intervals.
  - Plots illustrating the coverage and width of distributed confidence intervals.

---

## **Usage Instructions**

### **Prerequisites**
- Install the required R packages:
  ```r
  install.packages(c("snowfall", "mvtnorm", "EnvStats", "expm", "ggplot2", "tidyverse", "dplyr"))
  ```
  
### **Running the Scripts**
1. **Distributed Estimation**:
   - Navigate to `distributed_estimation/` and run an estimation script, e.g.:
     ```r
     source("distr_est_epsilon.R")
     ```
   - Simulation results will be saved in the `results/` folder.

2. **Distributed Inference**:
   - Navigate to `distributed_inference/` and run an inference script, e.g.:
     ```r
     source("distr_CI_epsilon.R")
     ```
   - Visualizations can be generated by knitting the `.Rmd` files in RStudio.

3. **Custom Functions**:
   - Source the functions in `utils/functions_estimation.R` for use in custom analyses (e.g., implementing a new robust loss function):
     ```r
     source("utils/functions_estimation.R")
     ```

---

## **Key Features**
- **Robust Estimation**:
  - Distributed implementation of M-estimators (Huber and other robust losses), capable of handling contamination in large datasets.
- **Simulation Studies**:
  - Explore the impact of contamination proportion, noise distribution, and local sample size on estimation accuracy.
- **Distributed Inference**:
  - Construct communication-efficient bootstrap confidence intervals for distributed estimators.
  - Demonstrate the necessity and benefits of de-biasing procedures under higher contamination levels.

---

## **Citation**
If you use this code in your research, please cite the following manuscript:  
Peiliang Zhang, Wen-Xin Zhou, and Zhao Ren. *Distributed Robust Estimation and Inference with Contaminated Data*, unpublished manuscript, 2025.

---

## **Contact**
For questions or issues, please contact:
Peiliang Zhang - [pez35@pitt.edu]


## **References**
1. Tan, K. M., Battey, H., & Zhou, W.-X. (2022). Communication-constrained distributed quantile regression with optimal statistical guarantees. *Journal of Machine Learning Research, 23*(272), 1–61. [Paper](https://jmlr.org/papers/v23/21-1269.html)

2. Barzilai, J., & Borwein, J. M. (1988). Two-point step size gradient methods. *IMA Journal of Numerical Analysis, 8*(1), 141–148. [Paper](https://academic.oup.com/imajna/article-abstract/8/1/141/802460)


